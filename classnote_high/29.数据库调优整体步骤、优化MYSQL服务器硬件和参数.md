1.调优的目标
    尽可能的节省系统资源,以便系统可以提供更大负荷的服务(吞吐量更大)
    合理的结构设计和参数跳转,以提高用户操作响应的速度
    减少系统的瓶颈,提高Mysql数据库整体的性能

2.调优的纬度和步骤
    第一步:选择合适的DBMS
      需要事务性处理以及较高安全性可以选择SQL Server、Oracle,单表存储上亿条数据是没有问题的,如果数据库设计的好,即使不用分库分表,查询效率也不差
      此外,还可以选用开源的Mysql,他有很多存储引擎可以选择,如果进行事务处理可以选择Innodb,非事务处理也可以选择MyISAM
　
    第二步:优化表设计
      表结构尽量遵循三范式;
      查询较多,尤其是多表联查时,可以采用反范式化进行优化,反范式化采用空间换时间的方式,通过增加冗余字段提高查询效率
      表字段的类型选择,一般来说,如果字段可以采用数值类型就不要采用字符类型;字符类型要尽可能设计得短一点,针对字符类型来说,当确定字符长度固定时,就可以
    采用char类型;当长度不固定时,通常采用varchar类型
　
    第三步:优化逻辑查询
      通过改变sql语句的内容让sql执行效率更高效,采用的方式是对SQL语句进行等价变换,对查询进行重写
　
    第四步:优化物理查询
      重点就是对索引的创建和使用
　
    第五步:使用Redis或Memcached作为缓存
　
    第六步:库级优化
      库级优化是站在数据库的纬度上进行的优化策略,比如控制一个库中的数据表数量;另外,单一的数据库总会遇到各种限制,不如取长补短,利用"外援"的方式,
    通过主从架构优化我们的读写策略,通过对数据库进行垂直或者水平切分,突破单一数据库或者数据表的访问限制,提升查询性能;
      1)读写分离
        如果读和写的业务量都很大,并且他们都在同一个数据库服务器中进行操作,那么数据库的性能就会出现瓶颈,为了提升系统性能,我们可以采取读写分离的方式
      降低主数据库的负载,比如用主数据库完成写操作,用从数据库完成读操作
      2)数据分片
        对数据库分库分表;当数据量达到千万级别以上,有时候我们需要把一个数据库切成多份,放到不同的数据库服务器上,减少对单一数据库服务器的访问压力;如果
      你使用的是Mysql,就可以使用Mysql自带的分区表功能,当然你也可以考虑自己做垂直拆分(分库)、水平拆分(分表)、垂直+水平(分库分表);

3.优化Mysql服务器
    1)优化服务器硬件————见PDF[优化Mysql服务器介绍](/pdf/第12章_数据库其它调优策略.pdf)
    2)优化Mysql的参数
      通过优化Mysql的参数可以提高资源利用率,从而达到提高Mysql服务器性能的目的
      Mysql服务的配置参数都在my.cnf或者my.ini文件的(mysqld)组中;配置完参数后,需要重新启动Mysql服务才会生效
      下面对几个对性能影响比较大的参数进行详细的介绍
        - innodb_buffer_pool_size: 这个参数是Mysql数据库最重要的参数之一,表示InnoDB类型的表和索引的最大缓存,它不仅仅缓存索引数据,还会缓存表的数据,
                                   这个值越大,查询的速度就会越快,但是这个值太大会影响操作系统的性能
        - key_buffer_size: 表示索引缓冲区的大小,索引缓冲区是所有的线程共享;增加索引缓冲区可以得到更好处理的索引(对所有读和多重写);当然这个值不是越大越好,
                           它的大小取决于内存的大小,如果这个值太大,就会导致操作系统频繁换页,也会降低系统性能;对于内存在4GB作用的服务器该参数可设置为256M
                           或384M
        - table_cache: 表示同时打开的表的个数,这个值越大,能够同时打开的表的个数越多;物理内存越大,设置就越大,默认为2402,调到512-1024最佳;这个值不是越大越好,
                       因为同时打开的表太多会影响操作系统的性能
        - sort_buffer_size: 表示每个需要进行排序的线程分配的缓冲区的大小,增加这个参数的值可以提高Order By或者Group By操作的速度,默认数值是2097144个字节
                            约2MB,对于内存在4GB左右的服务器推荐设置为6-8M,如果有100个连接,那么实际分配的总共排序缓冲区大小为100*6=600MB
        - join_buffer_size: 表示联合查询操作所能使用的缓冲区的大小,和sort_buffer_size一样,该参数对应的分配内存是每个连接独享
        - read_buffer_size: 表示每个线程连续扫描时为扫描的每个表分配的缓冲区的大小,当线程从表中连续读取记录时需要用到这个缓冲区;
                            SET SESSION read_buffer_size = n,可以临时设置改参数的值,默认为64K,可以设置为4M;
        -innodb_flush_log_at_trx_commit: 表示何时将缓冲区的数据写入日志文件,并且将日志文件写入磁盘中,该参数对于InnoDB引擎非常重要,该参数有三个值,分别是0,1,2,
                                         该参数的默认值为1;
                                         值为0时,表示每秒一次的频率将数据写入日志文件并将日志文件写入磁盘,每个事务的commit并不会触发前面的任何操作;该模式速度最快,
                                        但不太安全,mysqld进程的崩溃会导致上一秒钟所有事务数据的丢失;
                                         值为1时,表示每次提交事务时将数据写入日志文件并将日志文件写入磁盘进行同步,该模式是最安全的,但也是最慢的一种方式,因为每次
                                        事务提交或事务外的指令都需要把日志写入磁盘
                                         值为2时,表示每次提交事务时将数据写入日志文件,每隔一秒将日志文件写入磁盘,该模式速度较快,也比0安全,只有在操作系统崩溃或
                                        系统断电的情况下,上一秒钟所有事务数据才可能丢失;
        -innodb_log_buffer_size: 这是Innodb存储引擎的事务日志所使用的缓冲区,为了提高性能,也是先将信息写入Innodb Log Buffer中,
                                 当满足innodb_flush_log_trx_commit参数所设置的条件(或者日志缓冲区写满)之后,才会将日志写到日志文件(或者同步到磁盘)之中
        -max_connections: 表示允许连接到Mysql数据库的最大数量,默认值是151,如果状态变量connection_errors_max_connections不为零,并且一直增长,这说明不断有连接
                          请求因数据库连接数已达到允许最大值而失败,这时可以考虑增大max_connections的值;在linux平台下,性能好的服务器,支持500-1000个连接不是难事,
                          需要根据服务器性能进行评估设定,这个连接数不是越大越好,因为这些连接会浪费内存的资源,过多的连接可能会导致Mysql服务器僵死; 
        -back_log: 用于控制Mysql监听TCP端口时设置的积压请求栈大小,如果Mysql的连接数达到max_connections时,新来的请求将会被存在堆栈中,以等待某一连接释放资源,该堆栈的
                   数量即back_log,如果等待连接的数量超过back_log,将不被授予链接资源,将会报错;5.6.6版本之前默认值为50,之后的默认版本为50+(max_connections/5),
                   对于需要数据库在较短时间内处理大量连接请求,可以考虑适当增大back_log的值;
        -thread_cacahe_size: 线程池缓存线程数量的大小,当客户端断开连接后将当前线程缓存起来,当在接到心的连接请求时快速响应无需创建新的线程,这尤其对那些使用短连接的应用程序
                             来说可以极大的提高创建连接的效率;那么为了提高性能可以增大该参数的值,默认为60,可以设置为120;
        -wait_timeout: 指定一个请求的最大连接时间,对于4GB左右内存的服务器可以设置为5-10
        -interactive_timeout: 表示服务器在关闭连接前等待行动的秒数;

4.一份my.cnf的参考
[mysqld]
port = 3306 
serverid = 1 
socket = /tmp/mysql.sock 
skip-locking #避免MySQL的外部锁定，减少出错几率增强稳定性。 
skip-name-resolve #禁止MySQL对外部连接进行DNS解析，使用这一选项可以消除MySQL进行DNS解析的时间;
                   但需要注意，如果开启该选项，则所有远程主机连接授权都要使用IP地址方式，否则MySQL将无法正常处理连接请求！ 
back_log = 384
key_buffer_size = 256M 
max_allowed_packet = 4M 
thread_stack = 256K
table_cache = 128K 
sort_buffer_size = 6M 
read_buffer_size = 4M
read_rnd_buffer_size=16M 
join_buffer_size = 8M 
myisam_sort_buffer_size = 64M 
table_cache = 512 
thread_cache_size = 64 
query_cache_size = 64M
tmp_table_size = 256M 
max_connections = 768 
max_connect_errors = 10000000
wait_timeout = 10 
thread_concurrency = 8 #该参数取值为服务器逻辑CPU数量*2，在本例中，服务器有2颗物理CPU，而每颗物理CPU又支持H.T超线程，所以实际取值为4*2=8 
skipnetworking #开启该选项可以彻底关闭MySQL的TCP/IP连接方式，如果WEB服务器是以远程连接的方式访问MySQL数据库服务器则不要开启该选项！否则将无法正常连接！ 
table_cache=1024
innodb_additional_mem_pool_size=4M #默认为2M 
innodb_flush_log_at_trx_commit=1
innodb_log_buffer_size=2M #默认为1M 
innodb_thread_concurrency=8 #你的服务器CPU有几个就设置为几。建议用默认一般为8 
tmp_table_size=64M #默认为16M，调到64-256最挂
thread_cache_size=120 
query_cache_size=32M